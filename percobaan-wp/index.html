<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dasbor Produktivitas WP</title>
    <!-- 1. CDN untuk Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 2. CDN untuk Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- 3. Google Fonts: Plus Jakarta Sans -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;700&display=swap" rel="stylesheet">
    <!-- 4. Bootstrap Icons CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        /* Style dasar */
        :root {
            --accent-color: #0ea5e9;
            --bg-color: #000000;
            --text-color: #ffffff;
            --surface-color: #1a1a1a;
            --surface-hover: #2a2a2a;
        }
        .theme-light {
            --bg-color: #ffffff;
            --text-color: #000000;
            --surface-color: #f0f0f0;
            --surface-hover: #e0e0e0;
        }
        body{
            height: 90vh;
        }
        body, #app {
            font-family: 'Plus Jakarta Sans', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow: hidden; 
            background-color: var(--bg-color);
            color: var(--text-color);
            
        }
        .text-accent { color: var(--accent-color); }
        .bg-accent { background-color: var(--accent-color); }
        .border-accent { border-color: var(--accent-color); }
        .ring-accent { --tw-ring-color: var(--accent-color); }

        /* Transisi & Animasi */
        .view-enter-active, .view-leave-active, .fade-enter-active, .fade-leave-active {
            transition: all 0.3s ease-out;
        }
        .view-enter-from, .view-leave-to { transform: scale(1.05); opacity: 0; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        .slide-container { transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1); }

        .tile-flipper { transition: transform 0.6s; transform-style: preserve-3d; }
        .tile-container.is-flipped .tile-flipper { transform: rotateY(180deg); }
        .tile-front, .tile-back {
            position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden;
            backface-visibility: hidden; display: flex; flex-direction: column; justify-content: flex-end;
            padding: 0.75rem; overflow: hidden;
        }
        .tile-back { transform: rotateY(180deg); align-items: center; justify-content: center; }

        /* Drag & Drop Styles */
        .draggable-ghost { opacity: 0.4; border: 2px dashed var(--accent-color); }
        .edit-mode-wiggle { animation: wiggle 0.2s ease-in-out infinite alternate; }
        @keyframes wiggle { from { transform: rotate(-1deg); } to { transform: rotate(1deg); } }
    </style>
</head>
<body class="bg-black">

    <div id="app"></div>

    <script>
        const app = Vue.createApp({
            data() {
                return {
                    currentView: 'home',
                    isAppListVisible: false,
                    isEditMode: false,
                    editingTile: null,
                    longPressTimer: null,
                    longPressOccurred: false,
                    draggedTileIndex: null,
                    isLoading: {},
                    apiError: null,
                    touchStartX: 0,
                    touchMoveX: 0,
                    homeBackground: '',
                    newTodoText: '',
                    isAddingTask: false,
                    newKanbanTaskText: '',
                    newKanbanColumnIndex: 0,
                    accentColor: '#0ea5e9',
                    theme: 'dark',
                    tiles: [
                        { id: 1, nama: 'Tugas', view: 'todo', ukuran: 'sedang', warna: 'bg-accent', ikon: 'bi bi-check2-square' },
                        { id: 2, nama: 'Kanban', view: 'kanban', ukuran: 'lebar', warna: 'bg-accent', ikon: 'bi bi-kanban' },
                        { id: 3, nama: 'AI (Dummy)', view: 'ai_dummy', ukuran: 'sedang', warna: 'bg-teal-500', ikon: 'bi bi-stars' },
                        { id: 4, nama: 'Kalender', view: 'calendar', ukuran: 'sedang', warna: 'bg-accent', ikon: 'bi bi-calendar-event' },
                        { id: 5, nama: 'Pesan', view: 'messaging', ukuran: 'kecil', warna: 'bg-accent', ikon: 'bi bi-chat-left-text' },
                        { id: 6, nama: 'Kontak', view: 'people', ukuran: 'kecil', warna: 'bg-accent', ikon: 'bi bi-people' },
                        { id: 7, nama: 'Buat Tile', view: 'create_tile', ukuran: 'kecil', warna: 'bg-orange-500', ikon: 'bi bi-plus-lg' },
                        { id: 8, nama: 'Pengaturan', view: 'settings', ukuran: 'kecil', warna: 'bg-gray-700', ikon: 'bi bi-gear' },
                    ],
                    todos: [{ id: 1, text: 'Selesaikan laporan mingguan', completed: false }],
                    kanban: { columns: [ { title: 'Rencana', tasks: [] }, { title: 'Dikerjakan', tasks: [] }, { title: 'Selesai', tasks: [] } ] },
                    calendar: { date: new Date(), monthNames: ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"] }
                }
            },
            computed: {
                alphabeticalAppList() { return [...this.tiles].sort((a,b) => a.nama.localeCompare(b.nama)); },
                isAnyLoading() { return Object.values(this.isLoading).some(status => status); },
                pendingTodosCount() { return this.todos.filter(t => !t.completed).length; },
                calendarHeader() { return `${this.calendar.monthNames[this.calendar.date.getMonth()]} ${this.calendar.date.getFullYear()}`; },
                calendarDays() {
                    const date = new Date(this.calendar.date); const year = date.getFullYear(); const month = date.getMonth();
                    const firstDayOfMonth = new Date(year, month, 1).getDay(); const daysInMonth = new Date(year, month + 1, 0).getDate();
                    const daysArray = [];
                    for (let i = 0; i < firstDayOfMonth; i++) { daysArray.push(''); }
                    for (let i = 1; i <= daysInMonth; i++) { daysArray.push(i); }
                    return daysArray;
                }
            },
            methods: {
                setView(view, tile) { this.currentView = view; },
                goHome() { this.currentView = 'home'; this.isAddingTask = false; this.isEditMode = false; },
                getGridClasses(ukuran) {
                    const sizes = { 'kecil': 'col-span-1 row-span-1', 'sedang': 'col-span-2 row-span-2', 'lebar': 'col-span-3 row-span-2' };
                    return sizes[ukuran] || sizes['kecil'];
                },
                triggerBgUpload() { document.getElementById('bg-upload').click(); },
                handleBgUpload(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            this.homeBackground = e.target.result;
                            localStorage.setItem('homeBg', e.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                },
                // --- Edit Mode & Drag Drop ---
                handleTilePressStart(tile) {
                    if (this.isEditMode) return;
                    this.longPressOccurred = false;
                    clearTimeout(this.longPressTimer);
                    this.longPressTimer = setTimeout(() => {
                        this.isEditMode = true;
                        this.longPressOccurred = true;
                    }, 2000);
                },
                handleTilePressEnd(tile) {
                    clearTimeout(this.longPressTimer);
                    if (!this.longPressOccurred && !this.isEditMode) {
                        this.setView(tile.view, tile);
                    }
                },
                handleTilePressMove() {
                    clearTimeout(this.longPressTimer);
                },
                openEditModal(tile) { this.editingTile = {...tile}; },
                closeEditModal() { this.editingTile = null; },
                saveTileChanges() {
                    const index = this.tiles.findIndex(t => t.id === this.editingTile.id);
                    if (index !== -1) {
                        this.tiles[index] = this.editingTile;
                    }
                    this.closeEditModal();
                },
                handleDragStart(index) { this.draggedTileIndex = index; },
                handleDrop(targetIndex) {
                    if (this.draggedTileIndex === null) return;
                    const draggedItem = this.tiles.splice(this.draggedTileIndex, 1)[0];
                    this.tiles.splice(targetIndex, 0, draggedItem);
                    this.draggedTileIndex = null;
                },

                // --- Create Tile ---
                createCustomTile(event) {
                    event.preventDefault();
                    const formData = new FormData(event.target);
                    const newTile = {
                        id: Date.now(),
                        nama: formData.get('nama') || 'Tile Baru',
                        view: 'dummy_view',
                        ukuran: formData.get('ukuran') || 'kecil',
                        warna: `bg-[${formData.get('warna')}]` || 'bg-gray-500',
                        ikon: formData.get('ikon') || 'bi bi-app'
                    };
                    this.tiles.push(newTile);
                    this.goHome();
                },

                // --- Swipe Navigation ---
                handleGlobalTouchStart(e) { if(e.target.closest('.custom-scrollbar') || this.isEditMode) return; this.touchStartX = e.touches[0].clientX; },
                handleGlobalTouchMove(e) { if(e.target.closest('.custom-scrollbar') || this.isEditMode) return; this.touchMoveX = e.touches[0].clientX; },
                handleGlobalTouchEnd() {
                    if (this.touchStartX === 0) return;
                    const deltaX = this.touchStartX - this.touchMoveX;
                    if (this.currentView === 'home' && !this.isAppListVisible && deltaX > 50) this.isAppListVisible = true;
                    else if (this.isAppListVisible && deltaX < -50) this.isAppListVisible = false;
                    this.touchStartX = 0; this.touchMoveX = 0;
                },

                // --- App Logic (Todo, Kanban, Calendar) ---
                addTodo() {
                    if (this.newTodoText.trim()) {
                        this.todos.unshift({ id: Date.now(), text: this.newTodoText, completed: false });
                        this.newTodoText = ''; this.isAddingTask = false;
                    }
                },
                toggleTodo(id) {
                    const todo = this.todos.find(t => t.id === id);
                    if (todo) todo.completed = !todo.completed;
                },
                addKanbanTask() {
                    if (this.newKanbanTaskText.trim()) {
                        this.kanban.columns[this.newKanbanColumnIndex].tasks.unshift({ id: Date.now(), text: this.newKanbanTaskText });
                        this.newKanbanTaskText = ''; this.isAddingTask = false;
                    }
                },
                changeMonth(offset) {
                    const newDate = new Date(this.calendar.date);
                    newDate.setMonth(newDate.getMonth() + offset);
                    this.calendar.date = newDate;
                },

                // --- Settings Logic ---
                setTheme(themeName) {
                    this.theme = themeName;
                    document.body.classList.remove('theme-light');
                    if (themeName === 'light') document.body.classList.add('theme-light');
                    localStorage.setItem('theme', themeName);
                },
                setAccentColor(color) {
                    this.accentColor = color; document.documentElement.style.setProperty('--accent-color', color);
                    this.tiles.forEach(tile => {
                        if (['todo', 'kanban', 'calendar', 'messaging', 'people'].includes(tile.view)) {
                            tile.warna = 'bg-accent';
                        }
                    });
                },
            },
            mounted() {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme) this.setTheme(savedTheme);

                const savedBg = localStorage.getItem('homeBg');
                if (savedBg) this.homeBackground = savedBg;

                this.setAccentColor(this.accentColor);
            },
            template: `
            <div class="w-screen h-screen relative overflow-hidden" :class="{'bg-black text-white': theme === 'dark', 'bg-white text-black': theme === 'light'}"
                 @touchstart="handleGlobalTouchStart" @touchmove="handleGlobalTouchMove" @touchend="handleGlobalTouchEnd">
                
                <div class="absolute inset-0 w-[200vw] h-full flex slide-container" :style="{ transform: isAppListVisible ? 'translateX(-50%)' : 'translateX(0)' }">
                    <!-- Home Screen Wrapper -->
                    <div class="w-[100vw] h-full relative" :style="{ backgroundImage: 'url(' + homeBackground + ')', backgroundSize: 'cover', backgroundPosition: 'center' }">
                        <div v-if="homeBackground" class="absolute inset-0" :class="theme === 'dark' ? 'bg-black/70' : 'bg-white/70'"></div>
                        <div class="absolute inset-0 overflow-y-auto custom-scrollbar p-4">
                             <div class="grid grid-cols-3 auto-rows-[theme(spacing.24)] sm:auto-rows-[theme(spacing.28)] gap-4">
                                <div v-for="(tile, index) in tiles" :key="tile.id"
                                   @mousedown="handleTilePressStart(tile)"
                                   @mouseup="handleTilePressEnd(tile)"
                                   @mouseleave="handleTilePressMove"
                                   @mousemove="handleTilePressMove"
                                   @touchstart.prevent="handleTilePressStart(tile)"
                                   @touchend.prevent="handleTilePressEnd(tile)"
                                   @touchmove="handleTilePressMove"
                                   :draggable="isEditMode" @dragstart="handleDragStart(index)" @dragover.prevent @drop="handleDrop(index)"
                                   :class="[getGridClasses(tile.ukuran), {'draggable-ghost': index === draggedTileIndex}]"
                                   class="relative tile-container cursor-pointer transition-all duration-300">
                                   <div class="tile-flipper h-full w-full">
                                       <div class="tile-front" :class="[tile.warna === 'bg-accent' ? 'bg-accent' : tile.warna]">
                                           <i :class="tile.ikon" class="text-2xl mb-1"></i>
                                           <span class="text-base font-medium text-white truncate">{{ tile.nama }}</span>
                                       </div>
                                   </div>
                                   <div v-if="isEditMode" class="absolute inset-0 bg-black/30 flex items-center justify-center">
                                       <button @click="openEditModal(tile)" class="w-10 h-10 rounded-full bg-black/50 hover:bg-black/70 flex items-center justify-center">
                                            <i class="bi bi-pencil-fill text-white"></i>
                                       </button>
                                   </div>
                                </div>
                            </div>
                        </div>
                        <button v-if="isEditMode" @click="isEditMode = false" class="absolute bottom-4 right-4 bg-accent text-white px-4 py-2 rounded-full font-bold">Selesai</button>
                    </div>
                    <!-- App List Wrapper -->
                    <div class="w-[100vw] h-full flex flex-col" :style="{backgroundColor: 'var(--bg-color)'}">
                        <div class="p-4 flex-shrink-0"><h1 class="text-5xl font-light lowercase tracking-wide">aplikasi</h1></div>
                        <div class="flex-grow overflow-y-auto custom-scrollbar px-4">
                            <div v-for="app in alphabeticalAppList" :key="app.id" @click="setView(app.view, app); isAppListVisible = false;" 
                                 class="flex items-center p-3 cursor-pointer" :class="theme === 'dark' ? 'hover:bg-gray-900' : 'hover:bg-gray-100'">
                                <div class="w-12 h-12 flex items-center justify-center mr-4" :class="[app.warna === 'bg-accent' ? 'bg-accent' : app.warna]">
                                    <i :class="app.ikon" class="text-2xl text-white"></i>
                                </div>
                                <span class="text-xl" :style="{color: 'var(--text-color)'}">{{ app.nama }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- App View Wrapper -->
                <transition name="view">
                    <div v-if="currentView !== 'home'" class="absolute inset-0 z-20 flex flex-col" :style="{backgroundColor: 'var(--bg-color)'}">
                        <div class="p-4 flex-shrink-0"><h1 class="text-5xl font-light lowercase tracking-wide text-accent">{{ currentView }}</h1></div>
                        
                        <!-- Konten (Scrollable) -->
                        <div class="flex-grow overflow-y-auto custom-scrollbar px-4">
                            <!-- VIEWS KONTEN -->
                            <div v-if="currentView === 'todo'"> <!-- Konten Todo --> </div>
                            <div v-if="currentView === 'kanban'"> <!-- Konten Kanban --> </div>
                            <div v-if="currentView === 'calendar'"> <!-- Konten Kalender --> </div>
                            <div v-if="currentView === 'create_tile'" class="p-4">
                                <form @submit.prevent="createCustomTile">
                                    <div class="mb-4"> <label class="block mb-1">Nama Tile</label> <input name="nama" type="text" class="w-full p-2 bg-gray-800 rounded"> </div>
                                    <div class="mb-4"> <label class="block mb-1">Ikon (Kelas Bootstrap)</label> <input name="ikon" type="text" placeholder="cth: bi bi-star" class="w-full p-2 bg-gray-800 rounded"> </div>
                                    <div class="mb-4"> <label class="block mb-1">Warna</label> <input name="warna" type="color" class="w-full h-10 p-1"> </div>
                                    <div class="mb-4"> <label class="block mb-1">Ukuran</label> <select name="ukuran" class="w-full p-2 bg-gray-800 rounded"> <option>kecil</option> <option>sedang</option> <option>lebar</option> </select> </div>
                                    <button type="submit" class="w-full p-3 bg-accent font-bold rounded">Buat Tile</button>
                                </form>
                            </div>
                            <div v-if="currentView === 'settings'">
                                <h2 class="text-xl mb-4 font-bold">tampilan</h2>
                                <div class="mb-6"><label class="block mb-2 font-medium">mode</label>
                                    <div class="flex gap-2 p-1 bg-gray-800 rounded-full">
                                        <button @click="setTheme('light')" class="w-full py-2 rounded-full" :class="theme === 'light' ? 'bg-white text-black' : ''">Terang</button>
                                        <button @click="setTheme('dark')" class="w-full py-2 rounded-full" :class="theme === 'dark' ? 'bg-black text-white' : ''">Gelap</button>
                                    </div>
                                </div>
                                <div class="mb-6"><label class="block mb-2 font-medium">warna aksen</label>
                                    <div class="flex gap-2"><button @click="setAccentColor('#0ea5e9')" class="w-10 h-10 rounded-full bg-sky-500" :class="{'ring-2 ring-offset-2 ring-white ring-offset-black': accentColor === '#0ea5e9'}"></button> <!-- ... more colors --> </div>
                                </div>
                                <div><label class="block mb-2 font-medium">latar belakang</label><button @click="triggerBgUpload" class="bg-gray-800 px-4 py-2 flex items-center gap-2 hover:bg-gray-700"><i class="bi bi-image"></i> Pilih Gambar</button><input type="file" id="bg-upload" @change="handleBgUpload" class="hidden" accept="image/*"></div>
                            </div>
                            <div v-if="['messaging', 'people', 'music', 'ai_dummy', 'dummy_view'].includes(currentView)" class="text-center pt-20">
                                <p class="mt-4 text-gray-500">Fitur '{{ currentView }}' sedang dalam pengembangan.</p>
                            </div>
                        </div>

                        <!-- App Bar Bawah -->
                        <div class="flex-shrink-0 p-2 flex justify-center items-center gap-8 z-10" :style="{backgroundColor: 'var(--bg-color)'}">
                            <button @click="goHome" class="w-12 h-12 flex items-center justify-center rounded-full" :class="theme === 'dark' ? 'hover:bg-gray-800' : 'hover:bg-gray-200'"><i class="bi bi-arrow-left text-2xl"></i></button>
                            <button v-if="['todo', 'kanban'].includes(currentView)" @click="isAddingTask = !isAddingTask" class="w-14 h-14 flex items-center justify-center rounded-full bg-accent hover:opacity-80"><i class="bi bi-plus text-4xl text-white"></i></button>
                        </div>
                    </div>
                </transition>
                 <!-- Modal Edit Tile -->
                <transition name="fade">
                    <div v-if="editingTile" @click="closeEditModal" class="absolute inset-0 bg-black/70 z-40 flex items-center justify-center p-4">
                        <div @click.stop class="p-6 rounded-lg w-full max-w-sm" :style="{backgroundColor: 'var(--surface-color)'}">
                            <h3 class="text-2xl mb-4">Edit Tile</h3>
                            <div class="mb-4"> <label class="block mb-1">Nama</label> <input v-model="editingTile.nama" type="text" class="w-full p-2 rounded" :style="{backgroundColor: 'var(--surface-hover)'}"> </div>
                            <div class="mb-4"> <label class="block mb-1">Ikon</label> <input v-model="editingTile.ikon" type="text" class="w-full p-2 rounded" :style="{backgroundColor: 'var(--surface-hover)'}"> </div>
                            <button @click="saveTileChanges" class="w-full p-3 bg-accent font-bold rounded">Simpan</button>
                        </div>
                    </div>
                </transition>
            </div>
            `
        });
        
        app.mount('#app');
    </script>

</body>
</html>

