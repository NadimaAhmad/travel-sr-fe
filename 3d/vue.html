<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sutan Raya - 360 Viewer (Advanced Gyro)</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.css" />
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pannellum@2.5.6/build/pannellum.js"></script>

    <meta property="og:image" content="https://i.pinimg.com/736x/d4/c0/2a/d4c02ab6ea1144040cd0cb1174f39b94.jpg" />
    <meta property="og:description"
        content="Rasakan pengalaman mewah armada Sutan Raya dengan tur virtual 360 derajat. Jelajahi interior kendaraan kami yang nyaman dan modern." />
    <meta property="og:title" content="Sutan Raya - Tur Virtual Armada Mewah" />

    <style>
        :root {
            --sutan-dark: #121212;
            --sutan-gold: #d4af37;
        }

        body {
            background-color: var(--sutan-dark);
            color: white;
            font-family: "Plus Jakarta Sans", sans-serif;
        }
    </style>
</head>

<body class="antialiased">
    <div id="app"></div>

    <script>
        const {
            createApp,
            ref,
            onMounted,
            onUnmounted
        } = Vue;

        createApp({
            setup() {
                const isGyroSupported = ref(false);
                const isPermanentlyOff = ref(false);
                const deactivationClicks = ref(0);
                const isTemporarilyPaused = ref(false);
                const viewer = ref(null);

                const handleManualInteraction = () => {
                    if (!isPermanentlyOff.value) {
                        isTemporarilyPaused.value = true;
                        viewer.value.stopOrientation();
                    }
                };

                const handleDeviceMove = () => {
                    if (!isPermanentlyOff.value && isTemporarilyPaused.value) {
                        isTemporarilyPaused.value = false;
                        viewer.value.startOrientation();
                    }
                };

                const handleGyroToggle = () => {
                    if (isPermanentlyOff.value) return;

                    deactivationClicks.value += 1;
                    viewer.value.stopOrientation();

                    if (deactivationClicks.value > 2) {
                        isPermanentlyOff.value = true;
                    }
                };

                onMounted(() => {
                    // Initialize Pannellum viewer
                    viewer.value = pannellum.viewer("panorama-container", {
                        type: "equirectangular",
                        panorama: "image2.jpg",
                        autoLoad: true,
                        autoRotate: -2,
                        showControls: true,
                        compass: true,
                        orientationOnByDefault: true,
                    });

                    viewer.value.on('load', () => {
                        const supported = viewer.value.isOrientationSupported();
                        isGyroSupported.value = supported;

                        if (supported) {
                            viewer.value.getContainer().addEventListener('mousedown', handleManualInteraction, true);
                            viewer.value.getContainer().addEventListener('touchstart', handleManualInteraction, true);
                            window.addEventListener('deviceorientation', handleDeviceMove, true);
                        }
                    });
                });

                onUnmounted(() => {
                    if (viewer.value && viewer.value.isOrientationSupported()) {
                        viewer.value.getContainer().removeEventListener('mousedown', handleManualInteraction, true);
                        viewer.value.getContainer().removeEventListener('touchstart', handleManualInteraction, true);
                        window.removeEventListener('deviceorientation', handleDeviceMove, true);
                    }

                    if (viewer.value) {
                        viewer.value.destroy();
                    }
                });

                return {
                    isGyroSupported,
                    isPermanentlyOff,
                    deactivationClicks,
                    handleGyroToggle
                };
            },
            template: `
                <div class="min-h-screen flex flex-col items-center justify-center p-4">
                    <header class="text-center mb-8">
                        <img src="../image/logo.png" alt="Sutan Raya Logo" class="h-16 mx-auto mb-2" />
                        <h1 class="text-3xl font-bold text-[var(--sutan-gold)] tracking-wider">
                            Luxury Travel
                        </h1>
                        <p class="text-gray-400">
                            Rasakan pengalaman mewah armada kami.
                        </p>
                    </header>

                    <div class="w-full max-w-5xl h-[60vh] rounded-lg shadow-2xl overflow-hidden border-2 border-[var(--sutan-gold)]">
                        <div id="panorama-container" class="h-full w-full"></div>
                    </div>

                    <div v-if="isGyroSupported" class="mt-6 text-center">
                        <button 
                            @click="handleGyroToggle" 
                            :disabled="isPermanentlyOff" 
                            :class="{
                                'font-bold py-2 px-6 rounded-lg shadow-lg transition-all duration-300': true,
                                'bg-gray-600 text-gray-400 cursor-not-allowed': isPermanentlyOff,
                                'bg-[var(--sutan-gold)] text-black hover:bg-yellow-300': !isPermanentlyOff
                            }"
                        >
                            {{ isPermanentlyOff ? 'Giroskop Dimatikan' : \`Matikan Giroskop (\${deactivationClicks}/3)\` }}
                        </button>
                    </div>

                    <footer class="text-center mt-8 text-gray-500 text-sm">
                        <p>&copy; 2025 PO. Sutan Raya. All rights reserved.</p>
                    </footer>
                </div>
            `
        }).mount('#app');
    </script>
</body>

</html>